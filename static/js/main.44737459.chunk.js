(this["webpackJsonpchroma-chat-tutorial"]=this["webpackJsonpchroma-chat-tutorial"]||[]).push([[0],{13:function(e,t,n){"use strict";(function(e){var a=n(9),r=n.n(a),o=n(16),i=n(52),s=n.n(i),c=function(){var t;return{init:function(){var n=Object(o.a)(r.a.mark((function n(a){var o,i;return r.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,console.log(a),o=s.a.restClient.createRestClient(a,"78967baa4768cbcef11c508326ffb13a956689fcb6dc3ba17f4b895cbb1577a3",5),t=s.a.gtxClient.createClient(o,e.from("78967baa4768cbcef11c508326ffb13a956689fcb6dc3ba17f4b895cbb1577a3","hex"),[]),n.next=6,t.query("ping",{});case 6:return i=n.sent,console.log("Postchain client initialized."),n.abrupt("return",i);case 11:n.prev=11,n.t0=n.catch(0),console.error(n.t0);case 14:case"end":return n.stop()}}),n,null,[[0,11]])})));return function(e){return n.apply(this,arguments)}}(),getGtx:function(){return t}}}();t.a=c}).call(this,n(10).Buffer)},166:function(e,t,n){e.exports=n(293)},171:function(e,t,n){},188:function(e,t){},190:function(e,t){},224:function(e,t){},225:function(e,t){},28:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return u})),n.d(t,"e",(function(){return m})),n.d(t,"h",(function(){return d})),n.d(t,"g",(function(){return p})),n.d(t,"b",(function(){return g})),n.d(t,"j",(function(){return f})),n.d(t,"f",(function(){return y})),n.d(t,"i",(function(){return h})),n.d(t,"d",(function(){return b})),n.d(t,"c",(function(){return v}));var a,r,o,i,s=n(160),c=n(12),l=n(42),u=["1D","2D","3D","4D","5D","6D","7D","8D","9D","10D","JD","QD","KD","1H","2H","3H","4H","5H","6H","7H","8H","9H","10H","JH","QH","KH","1S","2S","3S","4S","5S","6S","7S","8S","9S","10S","JS","QS","KS","1C","2C","3C","4C","5C","6C","7C","8C","9C","10C","JC","QC","KC"],m=function(){return r},d=function(){a=Object(l.createConfig)(u.length);var e=Object(l.createPlayer)(a);return r={cardCodewordFragments:e.cardCodewordFragments.map((function(e){return e.toString("hex")})),keyPairs:e.keyPairs.map((function(e){return{privateKey:e.privateKey.toString("hex")}}))},o=null,i=[],{config:a,self:r}},p=function(e,t){return o=null,i=[],{config:a=t,self:r=e}},g=function(t){return Object(c.isEmpty)(r)?[]:(o={cardCodewordFragments:t,keyPairs:Array.from({length:53}).map((function(){return{}}))},i=Object(l.createDeck)([r,o].map((function(t){return t.cardCodewordFragments.map((function(t){return e.from(t,"hex")}))}))))},f=function(e){Object(c.isEmpty)(o)||(o.keyPairs=e.map((function(e){return{privateKey:e.decrypt_key}})))},y=function(){return h(i.map((function(e){return e.toString("hex")})))},h=function(t){return Object(l.encryptDeck)(Object(s.knuthShuffle)(t.map((function(t){return e.from(t,"hex")}))),e.from(r.keyPairs[a.cardCount].privateKey,"hex")).map((function(e){return e.toString("hex")}))},b=function(t){return Object(l.encryptDeck)(Object(l.decryptDeck)(t.map((function(t){return e.from(t,"hex")})),e.from(r.keyPairs[a.cardCount].privateKey,"hex")),r.keyPairs.map((function(t){return e.from(t.privateKey,"hex")}))).map((function(e){return e.toString("hex")}))},v=function(t,n){var a=t[n].encrypted,s=Object(l.decryptCard)(e.from(a,"hex"),[r,o].map((function(t){return e.from(t.keyPairs[n].privateKey,"hex")})));return u[i.findIndex((function(e){return e.equals(s)}))]}}).call(this,n(10).Buffer)},293:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(39),i=n.n(o),s=n(20),c=n(21),l=n(23),u=n(22),m=n(24),d=(n(171),n(34)),p=n(75),g=n(41),f=n(51),y=n(6),h=n(15),b=n(9),v=n.n(b),E=n(16),O=n(294),x=n(295),j=n(296),w=n(297),C=n(298),S=n(299),k=n(309),_=n(300),P=n(301),N=n(302),F=n(303),L=n(12),G=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={username:"",privKey:"",loginPrivKey:"",updating:!1},n.register=function(){var e=Object(E.a)(v.a.mark((function e(t){var a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),n.state.username){e.next=3;break}return e.abrupt("return");case 3:return n.setState({updating:!0}),e.next=6,y.a.register(n.state.username);case 6:a=e.sent,Object(L.isEmpty)(a)&&alert("Operation failed! Please try again."),n.setState({privKey:a.privKey,updating:!1});case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.login=function(){var e=Object(E.a)(v.a.mark((function e(t){var a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),n.state.loginPrivKey){e.next=3;break}return e.abrupt("return");case 3:return n.setState({updating:!0}),e.next=6,y.a.login(n.state.loginPrivKey);case 6:a=e.sent,Object(L.isEmpty)(a)?(alert("Unable to login! Invalid privKey or user does not exist."),n.setState({updating:!1})):n.props.history.push("/lobby");case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.onFieldChanged=function(e){return n.setState(Object(h.a)({},e.target.name,e.target.value))},n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){y.a.isLoggedIn()&&this.props.history.push("/lobby")}},{key:"render",value:function(){var e=this.state,t=e.privKey,n=e.username,a=e.updating,o=e.loginPrivKey;return r.a.createElement(O.a,{className:"justify-content-center align-items-center",style:{height:"100vh"}},r.a.createElement(x.a,{className:"m-auto",style:{paddingBottom:"20vh"},sm:"10",md:"6",lg:"5",xl:"4"},t?r.a.createElement(r.a.Fragment,null,r.a.createElement(P.a,null,r.a.createElement(N.a,null,r.a.createElement(w.a,null,r.a.createElement(F.a,null,"Username:"),r.a.createElement(S.a,{type:"text",readOnly:!0,name:"username",placeholder:"Username...",value:n})),t&&r.a.createElement(r.a.Fragment,null,r.a.createElement(w.a,null,r.a.createElement(F.a,null,"Private Key (Save this to login):"),r.a.createElement(S.a,{type:"textarea",name:"privKey",row:"3",value:t,readOnly:!0}))))),r.a.createElement("div",{className:"d-flex justify-content-center mt-3"},r.a.createElement(_.a,{color:"primary",tag:f.b,to:"/lobby"},"Let's Play!"))):r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",{className:"mb-3"},"Welcome!"),r.a.createElement(j.a,{onSubmit:this.login,className:"row"},r.a.createElement(w.a,{className:"col mb-0 flex-grow-1"},r.a.createElement(C.a,null,r.a.createElement(S.a,{type:"password",name:"loginPrivKey",required:!0,placeholder:"Private Key...",value:o,onChange:this.onFieldChanged}),r.a.createElement(k.a,{addonType:"append"},r.a.createElement(_.a,{style:{minWidth:"7em"},className:"btn-block",color:"primary",type:"submit",disabled:a},"Login"))))),r.a.createElement("div",{className:"text-center my-3"},"-- or --"),r.a.createElement(j.a,{onSubmit:this.register,className:"row"},r.a.createElement(w.a,{className:"col mb-0 flex-grow-1"},r.a.createElement(C.a,null,r.a.createElement(S.a,{type:"text",readOnly:t,required:!0,name:"username",placeholder:"Username...",value:n,onChange:this.onFieldChanged}),r.a.createElement(k.a,{addonType:"append"},r.a.createElement(_.a,{style:{minWidth:"7em"},className:"btn-block",color:"primary",type:"submit",disabled:a},"Register"))))))))}}]),t}(r.a.Component),D=Object(g.g)(G),K=n(304),A=n(305),T=n(13),I=n(32),R=n.n(I),U=function(){if(!y.a.isLoggedIn())return!1;var e=y.a.getCurrentUser(),t=e.id,n=e.privKey,a=e.pubKey,r=T.a.getGtx().newTransaction([a]);return r.addOperation("look_for_game",t,R.a.randomBytes(32)),r.sign(n,a),r.postAndWaitConfirmation()},H=function(){if(!y.a.isLoggedIn())return!1;var e=y.a.getCurrentUser(),t=e.id,n=e.privKey,a=e.pubKey,r=T.a.getGtx().newTransaction([a]);return r.addOperation("stop_looking_for_game",t,R.a.randomBytes(32)),r.sign(n,a),r.postAndWaitConfirmation()},M=function(e){if(!y.a.isLoggedIn())return!1;var t=y.a.getCurrentUser(),n=t.id,a=t.privKey,r=t.pubKey,o=T.a.getGtx().newTransaction([r]);return o.addOperation("join_game",n,e,R.a.randomBytes(32)),o.sign(a,r),o.postAndWaitConfirmation()},B=function(e,t){var n=y.a.getCurrentUser(),a=n.id,r=n.privKey,o=n.pubKey,i=T.a.getGtx().newTransaction([o]);return i.addOperation("post_message",e,a,t,R.a.randomBytes(32)),i.sign(r,o),i.postAndWaitConfirmation()},W=function(e){var t=y.a.getCurrentUser(),n=t.id,a=t.privKey,r=t.pubKey,o=T.a.getGtx().newTransaction([r]);return o.addOperation("resign",e,n,R.a.randomBytes(32)),o.sign(a,r),o.postAndWaitConfirmation()},z=function(e){return T.a.getGtx().query("get_game_status",{game:e})},V=function(e,t){var n=y.a.getCurrentUser(),a=n.id,r=n.privKey,o=n.pubKey,i=T.a.getGtx().newTransaction([o]);return i.addOperation("pass_shuffled_deck",e,a,t),i.sign(r,o),i.postAndWaitConfirmation()},J=function(e,t,n){var a=y.a.getCurrentUser(),r=a.id,o=a.privKey,i=a.pubKey,s=T.a.getGtx().newTransaction([i]);return s.addOperation("place_bet",e,r,t,n),s.sign(o,i),s.postAndWaitConfirmation()},q=function(e){var t=y.a.getCurrentUser(),n=t.id,a=t.privKey,r=t.pubKey,o=T.a.getGtx().newTransaction([r]);return o.addOperation("player_hit",e,n,R.a.randomBytes(32)),o.sign(a,r),o.postAndWaitConfirmation()},Q=function(e){var t=y.a.getCurrentUser(),n=t.id,a=t.privKey,r=t.pubKey,o=T.a.getGtx().newTransaction([r]);return o.addOperation("player_stand",e,n,R.a.randomBytes(32)),o.sign(a,r),o.postAndWaitConfirmation()},$=function(e){return T.a.getGtx().query("get_card_fragments",{game:e})},Y=function(e,t){var n=y.a.getCurrentUser(),a=n.id,r=n.privKey,o=n.pubKey,i=T.a.getGtx().newTransaction([o]);return i.addOperation("post_card_fragments",e,a,t),i.sign(r,o),i.postAndWaitConfirmation()},X=function(e,t,n){var a=y.a.getCurrentUser(),r=a.id,o=a.privKey,i=a.pubKey,s=T.a.getGtx().newTransaction([i]);return s.addOperation("post_card_secret",e,r,t,n),s.sign(o,i),s.postAndWaitConfirmation()},Z=function(e,t,n){console.log("Posting cardReveal: ".concat(n));var a=y.a.getCurrentUser(),r=a.id,o=a.privKey,i=a.pubKey,s=T.a.getGtx().newTransaction([i]);return s.addOperation("post_card_reveal",e,r,t,n),s.sign(o,i),s.postAndWaitConfirmation()},ee=function(e){var t=y.a.getCurrentUser(),n=t.id,a=t.privKey,r=t.pubKey,o=T.a.getGtx().newTransaction([r]);return o.addOperation("ready_for_next_round",e,n,R.a.randomBytes(32)),o.sign(a,r),o.postAndWaitConfirmation()},te=function(e){return"".concat(e,"_PENDING")},ne=function(e){return"".concat(e,"_REJECTED")},ae=function(e){return"".concat(e,"_FULFILLED")};function re(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function oe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?re(n,!0).forEach((function(t){Object(h.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):re(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ie="lobby/RESET",se="lobby/FETCH_STATUS",ce="lobby/LOOK_FOR_GAME",le="lobby/STOP_LOOKING_FOR_GAME",ue="lobby/JOIN_GAME",me={loading:!1,waitList:[],gameList:[],sending:!1,isLookingForGame:!1,error:null},de=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:me,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case te(se):return oe({},e,{loading:!0,error:null});case ae(se):var r=a.wait_list,o=a.game_list;return oe({},e,{loading:!1,waitList:r,gameList:o,isLookingForGame:e.sending?e.isLookingForGame:r.some((function(e){return e.id===y.a.getCurrentUser().id}))});case ne(se):return oe({},e,{loading:!1,error:a});case te(ce):return oe({},e,{sending:!0,isLookingForGame:!0,error:null});case te(le):return oe({},e,{sending:!0,isLookingForGame:!1,error:null});case ae(ce):case ae(le):return oe({},e,{sending:!1});case ne(ce):case ne(le):return oe({},e,{sending:!1,isLookingForGame:e.waitList.some((function(e){return e.id===y.a.getCurrentUser().id})),error:a});case te(ue):return oe({},e,{sending:!0,error:null});case ne(ue):return oe({},e,{sending:!1,error:a});case ie:return me;default:return e}},pe=n(61),ge=n.n(pe),fe=n(74),ye=n.n(fe),he=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={initialized:!1},n.logout=function(){y.a.logout(),n.props.history.push("/")},n.composeRedirectToGameHandler=function(e){return function(){return n.props.history.push("/game/".concat(e))}},n.findGame=function(){return n.props.lookForGame()},n.quitFindGame=function(){return n.props.stopLookingForGame()},n.composeJoinHandler=function(e){return function(){return n.props.joinGame(e)}},n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.props.reset(),this.getLobbyStatus=ye()(this.props.getLobbyStatus,1e3),this.getLobbyStatus()}},{key:"componentWillUnmount",value:function(){this.props.isLookingForGame&&this.props.stopLookingForGame()}},{key:"componentDidUpdate",value:function(e,t){e.loading&&!this.props.loading&&(this.state.initialized||this.setState({initialized:!0}),this.getLobbyStatus());var n=this.props,a=n.currentUser,r=n.gameList;if(e.gameList!==r){var o=r.find((function(e){return e.player_1===a.id||e.player_2===a.id}));o&&this.props.history.push("/game/".concat(o.id))}}},{key:"render",value:function(){var e=this,t=this.props,n=t.waitList,a=t.gameList,o=t.currentUser,i=t.isLookingForGame,s=t.sending;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"d-flex justify-content-end align-items-end py-4"},r.a.createElement("div",{className:"d-flex align-items-baseline"},r.a.createElement("div",null,"Welcome, ",o.username,"!"),r.a.createElement(_.a,{color:"outline-danger",className:"ml-3",onClick:this.logout},"Logout"))),r.a.createElement(O.a,null,this.state.initialized?r.a.createElement(r.a.Fragment,null,r.a.createElement(x.a,{lg:"6",className:"mb-3 mb-lg-0"},r.a.createElement(P.a,{style:{height:"100%"}},r.a.createElement(N.a,null,r.a.createElement("div",{className:"d-flex justify-content-between align-items-baseline"},r.a.createElement("h4",null,"Wait List"),this.state.initialized&&(i?r.a.createElement(_.a,{color:"outline-danger",onClick:this.quitFindGame,disabled:s},"Stop Finding"):r.a.createElement(_.a,{color:"primary",onClick:this.findGame,disabled:s},"Find Game"))),r.a.createElement("hr",null),r.a.createElement(A.a,{responsive:!0,borderless:!0,striped:!0,hover:!0},r.a.createElement("tbody",null,n.map((function(t){return r.a.createElement("tr",{key:t.id},r.a.createElement("td",null,ge()(t.timestamp).fromNow()),r.a.createElement("td",{valign:"middle"},t.username),r.a.createElement("td",{className:"text-right"},t.id!==o.id&&r.a.createElement(_.a,{color:"outline-primary",onClick:e.composeJoinHandler(t.id)},"Join")," "))}))))))),r.a.createElement(x.a,{lg:"6"},r.a.createElement(P.a,{style:{height:"100%"}},r.a.createElement(N.a,null,r.a.createElement("h4",null,"Active Games"),r.a.createElement("hr",null),r.a.createElement(A.a,{responsive:!0,borderless:!0,striped:!0,hover:!0},r.a.createElement("tbody",null,a.map((function(t){return r.a.createElement("tr",{key:t.id},r.a.createElement("td",null,ge()(t.timestamp).fromNow()),r.a.createElement("td",null,t.player_1_name),r.a.createElement("td",{valign:"middle"},t.player_2_name),r.a.createElement("td",{className:"text-right"},t.player_1!==o.id&&t.player_2!==o.id?r.a.createElement(_.a,{color:"outline-primary",onClick:e.composeRedirectToGameHandler(t.id)},"Spectate"):r.a.createElement(_.a,{color:"primary",onClick:e.composeRedirectToGameHandler(t.id)},"Play")," "))})))))))):r.a.createElement(x.a,{md:{size:4,offset:4},className:"pt-5"},r.a.createElement(K.a,{animated:!0,value:100}))))}}]),t}(r.a.Component),be={reset:function(){return{type:ie}},getLobbyStatus:function(){return{type:se,payload:T.a.getGtx().query("get_lobby_status",{})}},lookForGame:function(){return{type:ce,payload:U()}},stopLookingForGame:function(){return{type:le,payload:H()}},joinGame:function(e){return{type:ue,payload:M(e)}}},ve=Object(g.g)(Object(d.b)((function(e){var t=e.lobby,n=t.loading,a=t.waitList,r=t.gameList,o=t.sending,i=t.isLookingForGame;return{loading:n,sending:o,waitList:a,gameList:r,isWaitingForGameStart:t.isWaitingForGameStart,isLookingForGame:i,error:t.error,currentUser:y.a.getCurrentUser()}}),be)(he)),Ee=n(37),Oe=n(28);function xe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function je(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xe(n,!0).forEach((function(t){Object(h.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xe(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var we="game/RESET",Ce="game/FETCH_STATUS",Se="game/FETCH_FRAGMENTS",ke="game/POST_MESSAGE",_e="game/PASS_SHUFFLED_DECK",Pe="game/PLACE_BET",Ne="game/READY_FOR_NEXT_ROUND",Fe="game/HIT",Le="game/STAND",Ge="game/RESIGN",De={PASS_SHUFFLED_DECK:"game/PASS_SHUFFLED_DECK",PLACE_BET:"game/PLACE_BET"},Ke=function(e){return y.a.getCurrentUser().id===e.player_1},Ae=function(e){return y.a.getCurrentUser().id===e.player_2},Te=function(e,t,n,a){t.pendingActions[De.PASS_SHUFFLED_DECK]||Object(L.isEmpty)(t.cardCodewords)||Ie(e,n,a);var r=Object(Oe.e)();if(!Object(L.isEmpty)(r)){var o=!0,i=!1,s=void 0;try{for(var c,l=a.cards_in_player_hand[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var u=c.value,m=!0,d=!1,p=void 0;try{for(var g,f=u[Symbol.iterator]();!(m=(g=f.next()).done);m=!0){var y=g.value;if(y.is_open&&!a.deck[y.card_index].reveal_value&&(X(n,y.card_index,r.keyPairs[y.card_index].privateKey),!Object(L.isEmpty)(a.card_decrypts[1-t.myPlayerIndex][y.card_index].decrypt_key))){Object(Oe.j)(a.card_decrypts[1-t.myPlayerIndex]);try{var h=Object(Oe.c)(a.deck,y.card_index);Z(n,y.card_index,h)}catch(b){console.error(b)}}}}catch(v){d=!0,p=v}finally{try{m||null==f.return||f.return()}finally{if(d)throw p}}}}catch(v){i=!0,s=v}finally{try{o||null==l.return||l.return()}finally{if(i)throw s}}}},Ie=function(){var e=Object(E.a)(v.a.mark((function e(t,n,a){var r,o;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=a.game_state.phrase,o=a.deck,!(-4===r&&Ae(a.game)||-3===r&&Ke(a.game))){e.next=12;break}return e.prev=3,e.next=6,Re(t,n,o,-4===r);case 6:e.next=12;break;case 8:e.prev=8,e.t0=e.catch(3),console.error(e.t0),alert("An error occured, please refresh the page to try again.");case 12:if(!(-2===r&&Ae(a.game)||-1===r&&Ke(a.game))){e.next=22;break}return e.prev=13,e.next=16,Ue(t,n,a.deck);case 16:e.next=22;break;case 18:e.prev=18,e.t1=e.catch(13),console.error(e.t1),alert("An error occured, please refresh the page to try again.");case 22:case"end":return e.stop()}}),e,null,[[3,8],[13,18]])})));return function(t,n,a){return e.apply(this,arguments)}}(),Re=function(){var e=Object(E.a)(v.a.mark((function e(t,n,a,r){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(E.a)(v.a.mark((function e(o,i){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t({type:_e,payload:V(n,r?Object(Oe.f)():Object(Oe.i)(a.map((function(e){return e.encrypted}))))});case 3:o(),e.next=10;break;case 6:e.prev=6,e.t0=e.catch(0),console.error(e.t0),i();case 10:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t,n){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})));return function(t,n,a,r){return e.apply(this,arguments)}}(),Ue=function(){var e=Object(E.a)(v.a.mark((function e(t,n,a){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(E.a)(v.a.mark((function e(r,o){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t({type:_e,payload:V(n,Object(Oe.d)(a.map((function(e){return e.encrypted}))))});case 3:r(),e.next=10;break;case 6:e.prev=6,e.t0=e.catch(0),console.error(e.t0),o();case 10:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t,n){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),He={myPlayerIndex:-1,loadingGameStatus:!1,loadingCardFragments:!1,messages:[],game:{},gameState:{},cardCodewords:[],deck:[],cardsInPlayerHand:[[],[],[]],handsValue:[0,0,0],playerBets:[],playerMonies:[],pendingMessages:[],fulfilledMessages:[],pendingActions:{},sending:!1,resigning:!1,isReadyForNextRound:!1,error:null},Me=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:He,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload,r=t.meta;switch(n){case te(Ce):return je({},e,{loadingGameStatus:!0,error:null});case ae(Ce):var o=a.game,i=a.messages,s=a.game_state,c=a.deck,l=a.player_monies,u=a.player_bets,m=a.cards_in_player_hand,d=a.hands_value,p=m.map((function(e){return e.map((function(e){return je({},e,{revealValue:c[e.card_index].reveal_value})}))})),g=o.player_1===y.a.getCurrentUser().id?0:1,f=0!==s.phrase&&e.isReadyForNextRound;return je({},e,{myPlayerIndex:g,loadingGameStatus:!1,game:o,messages:i,gameState:s,deck:c,cardsInPlayerHand:p,handsValue:d,playerMonies:l,playerBets:u,fulfilledMessages:[],isReadyForNextRound:f});case ne(Ce):return je({},e,{loadingGameStatus:!1,error:a});case te(ke):return je({},e,{sending:!0,error:null,pendingMessages:[].concat(Object(Ee.a)(e.pendingMessages),[r.msg])});case ae(ke):return je({},e,{sending:!1,pendingMessages:e.pendingMessages.filter((function(e){return e.message!==r.msg.message})),fulfilledMessages:e.messages.some((function(e){return e.author_name==r.msg.author_name&&e.message===r.msg.message}))?e.fulfilledMessages:[].concat(Object(Ee.a)(e.fulfilledMessages),[r.msg])});case ne(ke):return je({},e,{sending:!1,pendingMessages:e.pendingMessages.filter((function(e){return e.message!==r.msg.message})),error:a});case te(Ge):return je({},e,{resigning:!0,error:null});case we:return He;case ne(Ge):return je({},e,{resigning:!1,error:a});case te(_e):return je({},e,{pendingActions:je({},e.pendingActions,Object(h.a)({},De.PASS_SHUFFLED_DECK,!0))});case ae(_e):return je({},e,{pendingActions:je({},e.pendingActions,Object(h.a)({},De.PASS_SHUFFLED_DECK,!1))});case te(Pe):return je({},e,{pendingActions:je({},e.pendingActions,Object(h.a)({},De.PLACE_BET,!0))});case ne(Pe):return je({},e,{pendingActions:je({},e.pendingActions,Object(h.a)({},De.PLACE_BET,!1))});case ae(Pe):return je({},e,{playerBets:[].concat(Object(Ee.a)(e.playerBets.filter((function(e){return e.id!==r.player}))),[{id:r.player,amount:r.amount}]),pendingActions:je({},e.pendingActions,Object(h.a)({},De.PLACE_BET,!1))});case te(Se):return je({},e,{loadingCardFragments:!0});case ae(Se):return Object(L.isEmpty)(a[0])||Object(L.isEmpty)(a[1])||!Object(L.isEmpty)(e.cardCodewords)?je({},e,{loadingCardFragments:!1}):je({},e,{loadingCardFragments:!1,cardCodewords:Object(Oe.b)(a[1-e.myPlayerIndex])});case ne(Se):return je({},e,{loadingCardFragments:!1});case te(Fe):case te(Le):return je({},e,{sending:!0});case ae(Fe):return je({},e,{sending:!1,cardsInPlayerHand:e.cardsInPlayerHand.map((function(t,n){return n!==e.myPlayerIndex+1||t.length===r.expectedHandSize?t:[].concat(Object(Ee.a)(t),[{card_index:e.gameState.top_card_index,revealValue:""}])}))});case ae(Le):return je({},e,{sending:!1,gameState:je({},e.gameState,{phrase:r.expectedPhrase})});case ne(Fe):case ne(Le):return je({},e,{sending:!1});case te(Ne):return je({},e,{isReadyForNextRound:!0});case ne(Ne):return je({},e,{isReadyForNextRound:!1});default:return e}},Be=n(165),We=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={value:Math.min(n.props.maxValue,10)},n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"d-flex align-items-center"},r.a.createElement("span",{style:{minWidth:"3em"},className:"mr-3 text-right"},"$",this.state.value),r.a.createElement(Be.a,{axis:"x",x:this.state.value,onChange:function(t){var n=t.x;return e.setState({value:n})},xmax:this.props.maxValue,xmin:1,styles:{active:{backgroundColor:"#007bff"}}}),r.a.createElement(_.a,{color:"primary",disabled:this.props.disabled,className:"ml-3",onClick:function(){return e.props.onSubmit(e.state.value)}},"OK"))}}]),t}(r.a.PureComponent),ze=n(308),Ve=n(306),Je=n(307),qe=function(e){return r.a.createElement(ze.a,{isOpen:e.isOpen,toggle:e.onClose},r.a.createElement(Ve.a,{toggle:e.onClose},"Rules"),r.a.createElement(Je.a,null,"This game is basically Blackjack (21) with some small changes:",r.a.createElement("ul",null,r.a.createElement("li",null,"Use only a single 52 deck. No reshuffle."),r.a.createElement("li",null,"The goal is to have more money than your opponent at the end of the game."),r.a.createElement("li",null,"Game ends when the deck has run out of card:",r.a.createElement("ul",null,r.a.createElement("li",null,"At start of each round, if the deck has less than 6 cards, the game ends immediately."),r.a.createElement("li",null,"Otherwise, when the deck runs out of card, the current round is scored immediately, no one (not even dealer) can receive any more card."))),r.a.createElement("li",null,"Blackjack pays out 2:1, normal wins pay out 1:1."),r.a.createElement("li",null,"Currently you can only hit or stand, no double up or split yet (sorry!)"))))};function Qe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function $e(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qe(n,!0).forEach((function(t){Object(h.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qe(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ye=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={top:n.props.orinTop,left:n.props.orinLeft},n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;setTimeout((function(){return e.setState({top:e.props.top,left:0})}),0)}},{key:"render",value:function(){var e=this.state,t=e.top,n=e.left,a=this.props,o=a.cardName,i=a.style;return r.a.createElement("div",{className:"game-card",style:$e({},i,{top:t,left:n,width:100})},r.a.createElement("div",{className:"game-card-inner",style:{transform:"back"!==o?"none":"rotateY(180deg)"}},r.a.createElement("img",{className:"game-card-face",width:"100",alt:o,src:"".concat("/rell-game","/images/cards/").concat(o,".svg")}),r.a.createElement("img",{className:"game-card-back",width:"100",alt:"card-back",src:"".concat("/rell-game","/images/cards/back.svg")})))}}]),t}(r.a.Component),Xe=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).state={message:"",showingRules:!1},n.preloadImages=function(){Oe.a.forEach((function(e){(new Image).src="".concat("/rell-game","/images/cards/").concat(e,".svg")}))},n.toggleRules=function(){return n.setState({showingRules:!n.state.showingRules})},n.onMessageChanged=function(e){return n.setState({message:e.target.value})},n.postMessage=function(e){e.preventDefault(),n.props.postMessage(Number(n.props.match.params.gameId),n.state.message),n.setState({message:""})},n.leaveGame=function(){return n.props.history.push("/lobby")},n.confirmResign=function(){window.confirm("Are you sure you want to resign?")&&n.props.resign(Number(n.props.match.params.gameId))},n.placeBet=function(e){return n.props.placeBet(Number(n.props.match.params.gameId),n.props.gameState.round,e)},n.hit=function(){return n.props.hit(Number(n.props.match.params.gameId))},n.stand=function(){return n.props.stand(Number(n.props.match.params.gameId))},n.readyForNextRound=function(){return n.props.readyForNextRound(Number(n.props.match.params.gameId))},n.renderBettingPanel=function(e,t){var a=n.props.pendingActions[De.PLACE_BET]||!!t;return r.a.createElement(We,{onSubmit:n.placeBet,disabled:a,maxValue:Math.min(50,e)})},n.renderGameView=function(e){var t=n.props,a=t.cardsInPlayerHand,o=t.playerBets,i=t.playerMonies,s=t.game,c=t.gameState,l=t.handsValue,u=t.isReadyForNextRound,m=t.sending;return r.a.createElement("div",{className:"d-flex flex-column",style:{height:"100%"}},r.a.createElement("div",{id:"dealer-zone",className:"flex-grow-1 d-flex flex-column"},r.a.createElement("div",{className:"text-center pb-3"},"Deck: ",52-c.top_card_index," cards left"),r.a.createElement("div",{className:"d-flex flex-grow-1 flex-row-reverse justify-content-center align-items-start position-relative"},0===c.phrase?r.a.createElement("h3",{className:"d-flex align-items-center",style:{height:"100%"}},r.a.createElement("div",{className:"text-center"},"Round ",c.round,r.a.createElement("br",null),"Place your bet")):a[0].map((function(e,t){return r.a.createElement(Ye,{key:e.card_index,cardName:e.revealValue||"back",top:30*t,orinTop:-200,orinLeft:0,style:{marginRight:"".concat(0===t?0:-80,"px")}})})),c.phrase>3&&r.a.createElement("div",{className:"text-dark",style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontWeight:700,fontSize:"3rem",textShadow:"0 0 5px #ffffff"}},l[0]))),r.a.createElement("div",{id:"players-zone",className:"d-flex flex-grow-1"},Array.from({length:2}).map((function(e,t){return t+1})).map((function(t){var d=a[t],p=s["player_".concat(t)],g=s["player_".concat(t,"_name")],f=(o.find((function(e){return e.id===p}))||{}).amount,y=(i.find((function(e){return e.id===p}))||{}).amount,h=p===e.id,b=t===c.phrase,v=d.some((function(e){return""===e.revealValue}));return r.a.createElement("div",{key:t,className:"d-flex flex-column-reverse flex-grow-1 pb-5"},r.a.createElement("h4",{className:"text-center flex-0"},"".concat(g).concat(h?" (You)":""," - $").concat(y)),r.a.createElement("div",{className:"flex-0 d-flex justify-content-center align-items-center",style:{height:"3.5em"}},0===c.phrase&&h&&!f?n.renderBettingPanel(y,f):f?"Betting $".concat(f):" "),r.a.createElement("div",{className:"d-flex justify-content-center align-items-center",style:{height:"4.5em"}},h&&b&&!v&&r.a.createElement(r.a.Fragment,null,r.a.createElement(_.a,{color:"primary mx-1",onClick:n.hit,disabled:m},"Hit"),r.a.createElement(_.a,{color:"primary mx-1",onClick:n.stand,disabled:m},"Stand")),c.phrase>3&&h&&!u&&r.a.createElement(_.a,{className:"mx-1",color:"primary",onClick:n.readyForNextRound},"Next Round")),r.a.createElement("div",{className:"d-flex justify-content-center align-items-end position-relative"},d.map((function(e,n){return r.a.createElement(Ye,{key:e.card_index,cardName:e.revealValue||"back",top:30*-n,orinTop:-window.innerHeight/2-200,orinLeft:1===t?"50%":"-50%",style:{marginLeft:"".concat(0===n?0:-80,"px")}})})),c.phrase>3&&r.a.createElement("div",{className:"text-dark",style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontWeight:700,fontSize:"3rem",textShadow:"0 0 5px #ffffff"}},l[t])))}))))},n.renderLoader=function(e,t,n){return r.a.createElement("div",{className:"position-absolute d-flex flex-column justify-content-center align-items-center",style:{top:0,left:0,bottom:0,right:0}},r.a.createElement("div",{className:"lds-ellipsis"},r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null)),r.a.createElement("h4",{className:"px-5"},-4===e?"".concat(n," is shuffling the deck very carefully..."):-3===e?"".concat(t," is shuffling the deck very carefully..."):-2===e?"Players are double-checking the deck...":"Game starting soon..."))},n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.reset();var t=Number(this.props.match.params.gameId);this.getGameStatus=ye()((function(){return e.props.getGameStatus(t)}),500),this.getGameStatus(),this.preloadImages()}},{key:"componentDidUpdate",value:function(e,t){e.loadingGameStatus&&!this.props.loadingGameStatus&&(this.getGameStatus(),e.messages.length<this.props.messages.length&&(this.refs.messages.scrollTop=this.refs.messages.scrollHeight),Object(L.isEmpty)(e.game)&&!Object(L.isEmpty)(this.props.game)&&(Ke(this.props.game)||Ae(this.props.game))&&this.props.getCardFragments(this.props.game.id)),e.loadingCardFragments&&!this.props.loadingCardFragments&&Object(L.isEmpty)(this.props.cardCodewords)&&this.props.getCardFragments(this.props.game.id)}},{key:"render",value:function(){var e=this.props,t=e.messages,n=e.fulfilledMessages,a=e.pendingMessages,o=e.game,i=e.gameState,s=e.resigning,c=[].concat(Object(Ee.a)(t),Object(Ee.a)(n),Object(Ee.a)(a)),l=y.a.getCurrentUser();return r.a.createElement(r.a.Fragment,null,r.a.createElement(O.a,null,r.a.createElement(x.a,{lg:"9",className:"py-3 position-relative",style:{height:"100vh"}},!Object(L.isEmpty)(o)&&r.a.createElement(r.a.Fragment,null,i.phrase<0&&this.renderLoader(i.phrase,o.player_1_name,o.player_2_name),i.phrase>=0&&this.renderGameView(l),-1!==o.finished&&r.a.createElement("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.6)"},className:"d-flex justify-content-center align-items-center"},r.a.createElement("div",null,"Game has ended. Winner: ",1===o.winner?o.player_1_name:o.player_2_name,"!")),r.a.createElement("div",{className:"position-absolute d-flex justify-content-between",style:{left:10,right:10,top:10}},r.a.createElement(_.a,{color:"outline-primary",onClick:this.toggleRules},"? Rules ?"),-1!==o.finished||o.player_1!==l.id&&o.player_2!==l.id?r.a.createElement(_.a,{color:"outline-secondary",onClick:this.leaveGame},"Leave Game"):r.a.createElement(_.a,{color:"outline-secondary",disabled:s,onClick:this.confirmResign},"Resign")))),r.a.createElement(x.a,{lg:"3",className:"d-flex flex-column justify-content-end py-3 col-lg-3",style:{maxHeight:"100vh",background:"rgba(0,0,0,0.2)"}},r.a.createElement("div",{className:"flex-grow-1 d-flex flex-column justify-content-end",style:{overflow:"hidden"}},r.a.createElement("div",{style:{overflow:"auto"},ref:"messages"},c.length>0?c.map((function(e){return r.a.createElement("p",{style:{wordBreak:"break-word"},key:e.timestamp},r.a.createElement("b",{className:e.author_name===l.username?"text-primary":"text-secondary"},"[",ge()(e.timestamp).fromNow(),"] ",e.author_name),":",r.a.createElement("br",null),e.message)})):r.a.createElement("div",{className:"text-muted"},'Say something nice e.g. "Good game, have fun!"'))),r.a.createElement(j.a,{className:"flex-grow-0 mt-3",onSubmit:this.postMessage},r.a.createElement(S.a,{type:"text",autoComplete:"message",placeholder:"Chat...",value:this.state.message,onChange:this.onMessageChanged})))),r.a.createElement(qe,{isOpen:this.state.showingRules,onClose:this.toggleRules}))}}]),t}(r.a.Component),Ze={getGameStatus:function(e){return function(){var t=Object(E.a)(v.a.mark((function t(n,a){var r,o,i;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n({type:Ce,payload:z(e)});case 2:return r=t.sent,o=r.value,(Ke(o.game)||Ae(o.game))&&(i=a().game,Te(n,i,e,r.value)),t.abrupt("return",r);case 6:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()},postMessage:function(e,t){return{type:ke,payload:B(e,t),meta:{msg:{author_name:y.a.getCurrentUser().username,message:t,timestamp:(new Date).getTime()}}}},resign:function(e){return{type:Ge,payload:W(e)}},reset:function(){return{type:we}},placeBet:function(e,t,n){return{type:Pe,payload:J(e,t,n),meta:{player:y.a.getCurrentUser().id,amount:n}}},getCardFragments:function(e){return function(){var t=Object(E.a)(v.a.mark((function t(n,a){var r,o,i,s,c,l,u,m;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n({type:Se,payload:$(e)});case 2:if(r=t.sent,o=r.value,i=a().game,s=y.a.getCurrentUser(),c=Object(Oe.e)(),Object(L.isEmpty)(c)&&(l=JSON.parse(localStorage.getItem("gameSecrets_".concat(s.id))||"{}"),u=!Object(L.isEmpty)(l)&&l.gameId===i.game.id,m=u?Object(Oe.g)(l.self,l.config):Object(Oe.h)(),c=m.self,u||localStorage.setItem("gameSecrets_".concat(s.id),JSON.stringify({self:m.self,config:m.config,gameId:i.game.id}))),Object(L.isEmpty)(o[i.myPlayerIndex]))try{Y(i.game.id,c.cardCodewordFragments)}catch(d){console.error(d),alert("An error occured, please refresh the page to try again.")}return t.abrupt("return",r);case 10:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()},hit:function(e){return function(t,n){var a=n().game,r=a.cardsInPlayerHand[a.myPlayerIndex+1].length+1;return t({type:Fe,payload:q(e),meta:{expectedHandSize:r}})}},stand:function(e){return function(t,n){return t({type:Le,payload:Q(e),meta:{expectedPhrase:n().game.gameState.phrase+1}})}},readyForNextRound:function(e){return{type:Ne,payload:ee(e)}}},et=Object(g.g)(Object(d.b)((function(e){var t=e.game,n=t.sending,a=t.loadingGameStatus,r=t.loadingCardFragments,o=t.cardCodewords,i=t.resigning,s=t.messages,c=t.pendingMessages,l=t.fulfilledMessages,u=t.game,m=t.gameState,d=t.pendingActions;return{sending:n,resigning:i,loadingGameStatus:a,loadingCardFragments:r,cardCodewords:o,game:u,gameState:m,playerBets:t.playerBets,playerMonies:t.playerMonies,messages:s,fulfilledMessages:l,pendingMessages:c,pendingActions:d,cardsInPlayerHand:t.cardsInPlayerHand,handsValue:t.handsValue,isReadyForNextRound:t.isReadyForNextRound}}),Ze)(Xe));function tt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function nt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?tt(n,!0).forEach((function(t){Object(h.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tt(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var at="config/SET_NODE_LOCATION",rt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;Object(p.a)(t,["type","payload"]);switch(n){case at:return window.localStorage.setItem("nodeLocation",a),nt({},e,{nodeLocation:a});default:return e}},ot=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={location:"",loading:!1,success:!0},n.registerLocation=function(e){e.preventDefault(),n.state.location&&n.initializeNodeLocation()},n.onFieldChanged=function(e){return n.setState(Object(h.a)({},e.target.name,e.target.value))},n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=window.localStorage.getItem("nodeLocation","");e&&this.setState({location:e},this.initializeNodeLocation)}},{key:"initializeNodeLocation",value:function(){var e=Object(E.a)(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({loading:!0,success:!0}),e.next=3,T.a.init(this.state.location);case 3:if("pong"!==e.sent){e.next=11;break}return e.next=8,y.a.loginFromSession();case 8:this.props.setNodeLocation(this.state.location),e.next=12;break;case 11:this.setState({loading:!1,success:!1});case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state.location;return r.a.createElement(O.a,{className:"justify-content-center align-items-center",style:{height:"100vh"}},r.a.createElement(x.a,{className:"m-auto",style:{paddingBottom:"20vh"},sm:"10",md:"6",lg:"5",xl:"4"},r.a.createElement(P.a,null,r.a.createElement(N.a,null,this.state.loading?r.a.createElement("div",null,"Testing connection, please wait..."):r.a.createElement(j.a,{onSubmit:this.registerLocation},r.a.createElement(w.a,null,!this.state.success&&r.a.createElement("div",{className:"color-danger"},"Cannot connect to server!"),r.a.createElement(F.a,null,"Please enter node location:"),r.a.createElement(S.a,{type:"text",name:"location",placeholder:"https://try.chromia.dev/node/#####/",value:e,onChange:this.onFieldChanged})),r.a.createElement("div",{className:"d-flex justify-content-end"},r.a.createElement(_.a,{color:"primary",type:"submit"},"Connect")))))))}}]),t}(r.a.Component),it={setNodeLocation:function(e){return{type:at,payload:e}}},st=Object(d.b)(null,it)(ot),ct=function(e){var t=e.component,n=Object(p.a)(e,["component"]);return r.a.createElement(g.b,Object.assign({},n,{render:function(){return y.a.isLoggedIn()?r.a.createElement(t,n):r.a.createElement(g.a,{to:"/"})}}))},lt=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement(f.a,null,this.props.nodeLocation?r.a.createElement(g.d,null,r.a.createElement(ct,{path:"/lobby",component:ve}),r.a.createElement(ct,{path:"/game/:gameId",component:et}),r.a.createElement(g.b,{path:"/"},r.a.createElement(D,null))):r.a.createElement(st,null))}}]),t}(r.a.Component),ut=Object(d.b)((function(e){return{nodeLocation:e.config.nodeLocation}}))(lt),mt=n(162),dt=n(163),pt=n(164),gt=n(40),ft=Object(gt.combineReducers)({config:rt,lobby:de,game:Me}),yt=Object(gt.createStore)(ft,{},Object(mt.composeWithDevTools)(Object(gt.applyMiddleware)(dt.a,pt.a))),ht=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"container-fluid"},r.a.createElement(d.a,{store:yt},r.a.createElement(ut,null)))}}]),t}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(ht,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},6:function(e,t,n){"use strict";(function(e){var a=n(15),r=n(9),o=n.n(r),i=n(16),s=n(52),c=n.n(s),l=n(13);function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}var m=function(){var t={},n=function(){var e=Object(i.a)(o.a.mark((function e(t){var n,a,r,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=c.a.util.makeKeyPair(),a=n.pubKey,r=n.privKey,(i=l.a.getGtx().newTransaction([a])).addOperation("register",a,t),i.sign(r,a),e.next=8,i.postAndWaitConfirmation();case 8:return e.next=10,s(r.toString("hex"));case 10:return e.abrupt("return",e.sent);case 13:return e.prev=13,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",{});case 17:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t){return e.apply(this,arguments)}}(),r=function(){var e=Object(i.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=sessionStorage.getItem("userLogin"))){e.next=4;break}return e.next=4,m.login(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),s=function(){var n=Object(i.a)(o.a.mark((function n(a){var r,i,s,u,m,d;return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,r=e.from(a,"hex"),i=c.a.util.createPublicKey(r),s=i.toString("hex"),n.next=6,l.a.getGtx().query("get_user",{user_pubkey:s});case 6:return u=n.sent,m=u.id,d=u.username,t={id:m,username:d,pubKey:i,privKey:r},sessionStorage.setItem("userLogin",a),n.abrupt("return",{username:d,pubKey:s,privKey:a});case 14:return n.prev=14,n.t0=n.catch(0),console.error(n.t0),n.abrupt("return",{});case 18:case"end":return n.stop()}}),n,null,[[0,14]])})));return function(e){return n.apply(this,arguments)}}();return{register:n,login:s,loginFromSession:r,logout:function(){t={},sessionStorage.removeItem("userLogin")},isLoggedIn:function(){return!!t.privKey},getCurrentUser:function(){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(n,!0).forEach((function(t){Object(a.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},t)}}}();t.a=m}).call(this,n(10).Buffer)}},[[166,1,2]]]);
//# sourceMappingURL=main.44737459.chunk.js.map